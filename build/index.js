function ke(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var oe,ue;function be(){return ue||(ue=1,oe=function(t,e,n){if(t==null||e==null)return t;var i=String(t),r=typeof e=="number"?e:parseInt(e,10);if(isNaN(r)||!isFinite(r))return i;var c=i.length;if(c>=r)return i;var m=n==null?"":String(n);m===""&&(m=" ");for(var p=r-c;m.length<p;)m+=m;var d=m.length>p?m.substr(0,p):m;return i+d}),oe}var xe=be();const re=ke(xe);var N=9e15,Z=function(){for(var t=[],e=-323;e<=308;e++)t.push(+("1e"+e));return function(n){return t[n+323]}}(),l=function(t){return t instanceof L?t:new L(t)},E=function(t,e){return new L().fromMantissaExponent(t,e)},P=function(t,e){return new L().fromMantissaExponent_noNormalize(t,e)};function Ee(t,e,n,i){var r=e.mul(n.pow(i));return L.floor(t.div(r).mul(n.sub(1)).add(1).log10()/n.log10())}function we(t,e,n,i){return e.mul(n.pow(i)).mul(L.sub(1,n.pow(t))).div(L.sub(1,n))}var L=function(){function t(e){this.mantissa=NaN,this.exponent=NaN,e===void 0?(this.m=0,this.e=0):e instanceof t?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):this.fromString(e)}return Object.defineProperty(t.prototype,"m",{get:function(){return this.mantissa},set:function(e){this.mantissa=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"e",{get:function(){return this.exponent},set:function(e){this.exponent=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"s",{get:function(){return this.sign()},set:function(e){if(e===0)return this.e=0,void(this.m=0);this.sgn()!==e&&(this.m=-this.m)},enumerable:!1,configurable:!0}),t.fromMantissaExponent=function(e,n){return new t().fromMantissaExponent(e,n)},t.fromMantissaExponent_noNormalize=function(e,n){return new t().fromMantissaExponent_noNormalize(e,n)},t.fromDecimal=function(e){return new t().fromDecimal(e)},t.fromNumber=function(e){return new t().fromNumber(e)},t.fromString=function(e){return new t().fromString(e)},t.fromValue=function(e){return new t().fromValue(e)},t.fromValue_noAlloc=function(e){return e instanceof t?e:new t(e)},t.abs=function(e){return l(e).abs()},t.neg=function(e){return l(e).neg()},t.negate=function(e){return l(e).neg()},t.negated=function(e){return l(e).neg()},t.sign=function(e){return l(e).sign()},t.sgn=function(e){return l(e).sign()},t.round=function(e){return l(e).round()},t.floor=function(e){return l(e).floor()},t.ceil=function(e){return l(e).ceil()},t.trunc=function(e){return l(e).trunc()},t.add=function(e,n){return l(e).add(n)},t.plus=function(e,n){return l(e).add(n)},t.sub=function(e,n){return l(e).sub(n)},t.subtract=function(e,n){return l(e).sub(n)},t.minus=function(e,n){return l(e).sub(n)},t.mul=function(e,n){return l(e).mul(n)},t.multiply=function(e,n){return l(e).mul(n)},t.times=function(e,n){return l(e).mul(n)},t.div=function(e,n){return l(e).div(n)},t.divide=function(e,n){return l(e).div(n)},t.recip=function(e){return l(e).recip()},t.reciprocal=function(e){return l(e).recip()},t.reciprocate=function(e){return l(e).reciprocate()},t.cmp=function(e,n){return l(e).cmp(n)},t.compare=function(e,n){return l(e).cmp(n)},t.eq=function(e,n){return l(e).eq(n)},t.equals=function(e,n){return l(e).eq(n)},t.neq=function(e,n){return l(e).neq(n)},t.notEquals=function(e,n){return l(e).notEquals(n)},t.lt=function(e,n){return l(e).lt(n)},t.lte=function(e,n){return l(e).lte(n)},t.gt=function(e,n){return l(e).gt(n)},t.gte=function(e,n){return l(e).gte(n)},t.max=function(e,n){return l(e).max(n)},t.min=function(e,n){return l(e).min(n)},t.clamp=function(e,n,i){return l(e).clamp(n,i)},t.clampMin=function(e,n){return l(e).clampMin(n)},t.clampMax=function(e,n){return l(e).clampMax(n)},t.cmp_tolerance=function(e,n,i){return l(e).cmp_tolerance(n,i)},t.compare_tolerance=function(e,n,i){return l(e).cmp_tolerance(n,i)},t.eq_tolerance=function(e,n,i){return l(e).eq_tolerance(n,i)},t.equals_tolerance=function(e,n,i){return l(e).eq_tolerance(n,i)},t.neq_tolerance=function(e,n,i){return l(e).neq_tolerance(n,i)},t.notEquals_tolerance=function(e,n,i){return l(e).notEquals_tolerance(n,i)},t.lt_tolerance=function(e,n,i){return l(e).lt_tolerance(n,i)},t.lte_tolerance=function(e,n,i){return l(e).lte_tolerance(n,i)},t.gt_tolerance=function(e,n,i){return l(e).gt_tolerance(n,i)},t.gte_tolerance=function(e,n,i){return l(e).gte_tolerance(n,i)},t.log10=function(e){return l(e).log10()},t.absLog10=function(e){return l(e).absLog10()},t.pLog10=function(e){return l(e).pLog10()},t.log=function(e,n){return l(e).log(n)},t.log2=function(e){return l(e).log2()},t.ln=function(e){return l(e).ln()},t.logarithm=function(e,n){return l(e).logarithm(n)},t.pow10=function(e){return Number.isInteger(e)?P(1,e):E(Math.pow(10,e%1),Math.trunc(e))},t.pow=function(e,n){return typeof e=="number"&&e===10&&typeof n=="number"&&Number.isInteger(n)?P(1,n):l(e).pow(n)},t.exp=function(e){return l(e).exp()},t.sqr=function(e){return l(e).sqr()},t.sqrt=function(e){return l(e).sqrt()},t.cube=function(e){return l(e).cube()},t.cbrt=function(e){return l(e).cbrt()},t.dp=function(e){return l(e).dp()},t.decimalPlaces=function(e){return l(e).dp()},t.affordGeometricSeries=function(e,n,i,r){return Ee(l(e),l(n),l(i),r)},t.sumGeometricSeries=function(e,n,i,r){return we(e,l(n),l(i),r)},t.affordArithmeticSeries=function(e,n,i,r){return function(c,m,p,d){var u=m.add(d.mul(p)).sub(p.div(2)),f=u.pow(2);return u.neg().add(f.add(p.mul(c).mul(2)).sqrt()).div(p).floor()}(l(e),l(n),l(i),l(r))},t.sumArithmeticSeries=function(e,n,i,r){return function(c,m,p,d){var u=m.add(d.mul(p));return c.div(2).mul(u.mul(2).plus(c.sub(1).mul(p)))}(l(e),l(n),l(i),l(r))},t.efficiencyOfPurchase=function(e,n,i){return function(r,c,m){return r.div(c).add(r.div(m))}(l(e),l(n),l(i))},t.randomDecimalForTesting=function(e){if(20*Math.random()<1)return P(0,0);var n=10*Math.random();10*Math.random()<1&&(n=Math.round(n)),n*=Math.sign(2*Math.random()-1);var i=Math.floor(Math.random()*e*2)-e;return E(n,i)},t.prototype.normalize=function(){if(this.m>=1&&this.m<10)return this;if(this.m===0)return this.m=0,this.e=0,this;var e=Math.floor(Math.log10(Math.abs(this.m)));return this.m=e===-324?10*this.m/1e-323:this.m/Z(e),this.e+=e,this},t.prototype.fromMantissaExponent=function(e,n){return isFinite(e)&&isFinite(n)?(this.m=e,this.e=n,this.normalize(),this):(e=Number.NaN,n=Number.NaN,this)},t.prototype.fromMantissaExponent_noNormalize=function(e,n){return this.m=e,this.e=n,this},t.prototype.fromDecimal=function(e){return this.m=e.m,this.e=e.e,this},t.prototype.fromNumber=function(e){return isNaN(e)?(this.m=Number.NaN,this.e=Number.NaN):e===Number.POSITIVE_INFINITY?(this.m=1,this.e=N):e===Number.NEGATIVE_INFINITY?(this.m=-1,this.e=N):e===0?(this.m=0,this.e=0):(this.e=Math.floor(Math.log10(Math.abs(e))),this.m=this.e===-324?10*e/1e-323:e/Z(this.e),this.normalize()),this},t.prototype.fromString=function(e){if(e.indexOf("e")!==-1){var n=e.split("e");this.m=parseFloat(n[0]),this.e=parseFloat(n[1]),this.normalize()}else if(e==="NaN")this.m=Number.NaN,this.e=Number.NaN;else if(this.fromNumber(parseFloat(e)),isNaN(this.m))throw Error("[DecimalError] Invalid argument: "+e);return this},t.prototype.fromValue=function(e){return e instanceof t?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"?this.fromString(e):(this.m=0,this.e=0,this)},t.prototype.toNumber=function(){if(!isFinite(this.e))return Number.NaN;if(this.e>308)return this.m>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;if(this.e<-324)return 0;if(this.e===-324)return this.m>0?5e-324:-5e-324;var e=this.m*Z(this.e);if(!isFinite(e)||this.e<0)return e;var n=Math.round(e);return Math.abs(n-e)<1e-10?n:e},t.prototype.mantissaWithDecimalPlaces=function(e){if(isNaN(this.m)||isNaN(this.e))return Number.NaN;if(this.m===0)return 0;var n=e+1,i=Math.ceil(Math.log10(Math.abs(this.m))),r=Math.round(this.m*Math.pow(10,n-i))*Math.pow(10,i-n);return parseFloat(r.toFixed(Math.max(n-i,0)))},t.prototype.toString=function(){return isNaN(this.m)||isNaN(this.e)?"NaN":this.e>=N?this.m>0?"Infinity":"-Infinity":this.e<=-N||this.m===0?"0":this.e<21&&this.e>-7?this.toNumber().toString():this.m+"e"+(this.e>=0?"+":"")+this.e},t.prototype.toExponential=function(e){if(isNaN(this.m)||isNaN(this.e))return"NaN";if(this.e>=N)return this.m>0?"Infinity":"-Infinity";if(this.e<=-N||this.m===0)return"0"+(e>0?re(".",e+1,"0"):"")+"e+0";if(this.e>-324&&this.e<308)return this.toNumber().toExponential(e);isFinite(e)||(e=17);var n=e+1,i=Math.max(1,Math.ceil(Math.log10(Math.abs(this.m))));return(Math.round(this.m*Math.pow(10,n-i))*Math.pow(10,i-n)).toFixed(Math.max(n-i,0))+"e"+(this.e>=0?"+":"")+this.e},t.prototype.toFixed=function(e){return isNaN(this.m)||isNaN(this.e)?"NaN":this.e>=N?this.m>0?"Infinity":"-Infinity":this.e<=-N||this.m===0?"0"+(e>0?re(".",e+1,"0"):""):this.e>=17?this.m.toString().replace(".","").padEnd(this.e+1,"0")+(e>0?re(".",e+1,"0"):""):this.toNumber().toFixed(e)},t.prototype.toPrecision=function(e){return this.e<=-7?this.toExponential(e-1):e>this.e?this.toFixed(e-this.e-1):this.toExponential(e-1)},t.prototype.valueOf=function(){return this.toString()},t.prototype.toJSON=function(){return this.toString()},t.prototype.toStringWithDecimalPlaces=function(e){return this.toExponential(e)},t.prototype.abs=function(){return P(Math.abs(this.m),this.e)},t.prototype.neg=function(){return P(-this.m,this.e)},t.prototype.negate=function(){return this.neg()},t.prototype.negated=function(){return this.neg()},t.prototype.sign=function(){return Math.sign(this.m)},t.prototype.sgn=function(){return this.sign()},t.prototype.round=function(){return this.e<-1?new t(0):this.e<17?new t(Math.round(this.toNumber())):this},t.prototype.floor=function(){return this.e<-1?Math.sign(this.m)>=0?new t(0):new t(-1):this.e<17?new t(Math.floor(this.toNumber())):this},t.prototype.ceil=function(){return this.e<-1?Math.sign(this.m)>0?new t(1):new t(0):this.e<17?new t(Math.ceil(this.toNumber())):this},t.prototype.trunc=function(){return this.e<0?new t(0):this.e<17?new t(Math.trunc(this.toNumber())):this},t.prototype.add=function(e){var n,i,r=l(e);if(this.m===0)return r;if(r.m===0)return this;if(this.e>=r.e?(n=this,i=r):(n=r,i=this),n.e-i.e>17)return n;var c=Math.round(1e14*n.m+1e14*i.m*Z(i.e-n.e));return E(c,n.e-14)},t.prototype.plus=function(e){return this.add(e)},t.prototype.sub=function(e){return this.add(l(e).neg())},t.prototype.subtract=function(e){return this.sub(e)},t.prototype.minus=function(e){return this.sub(e)},t.prototype.mul=function(e){if(typeof e=="number")return e<1e307&&e>-1e307?E(this.m*e,this.e):E(1e-307*this.m*e,this.e+307);var n=typeof e=="string"?new t(e):e;return E(this.m*n.m,this.e+n.e)},t.prototype.multiply=function(e){return this.mul(e)},t.prototype.times=function(e){return this.mul(e)},t.prototype.div=function(e){return this.mul(l(e).recip())},t.prototype.divide=function(e){return this.div(e)},t.prototype.divideBy=function(e){return this.div(e)},t.prototype.dividedBy=function(e){return this.div(e)},t.prototype.recip=function(){return E(1/this.m,-this.e)},t.prototype.reciprocal=function(){return this.recip()},t.prototype.reciprocate=function(){return this.recip()},t.prototype.cmp=function(e){var n=l(e);if(this.m===0){if(n.m===0)return 0;if(n.m<0)return 1;if(n.m>0)return-1}if(n.m===0){if(this.m<0)return-1;if(this.m>0)return 1}if(this.m>0)return n.m<0||this.e>n.e?1:this.e<n.e?-1:this.m>n.m?1:this.m<n.m?-1:0;if(this.m<0)return n.m>0||this.e>n.e?-1:this.e<n.e||this.m>n.m?1:this.m<n.m?-1:0;throw Error("Unreachable code")},t.prototype.compare=function(e){return this.cmp(e)},t.prototype.eq=function(e){var n=l(e);return this.e===n.e&&this.m===n.m},t.prototype.equals=function(e){return this.eq(e)},t.prototype.neq=function(e){return!this.eq(e)},t.prototype.notEquals=function(e){return this.neq(e)},t.prototype.lt=function(e){var n=l(e);return this.m===0?n.m>0:n.m===0?this.m<=0:this.e===n.e?this.m<n.m:this.m>0?n.m>0&&this.e<n.e:n.m>0||this.e>n.e},t.prototype.lte=function(e){return!this.gt(e)},t.prototype.gt=function(e){var n=l(e);return this.m===0?n.m<0:n.m===0?this.m>0:this.e===n.e?this.m>n.m:this.m>0?n.m<0||this.e>n.e:n.m<0&&this.e<n.e},t.prototype.gte=function(e){return!this.lt(e)},t.prototype.max=function(e){var n=l(e);return this.lt(n)?n:this},t.prototype.min=function(e){var n=l(e);return this.gt(n)?n:this},t.prototype.clamp=function(e,n){return this.max(e).min(n)},t.prototype.clampMin=function(e){return this.max(e)},t.prototype.clampMax=function(e){return this.min(e)},t.prototype.cmp_tolerance=function(e,n){var i=l(e);return this.eq_tolerance(i,n)?0:this.cmp(i)},t.prototype.compare_tolerance=function(e,n){return this.cmp_tolerance(e,n)},t.prototype.eq_tolerance=function(e,n){var i=l(e);return t.lte(this.sub(i).abs(),t.max(this.abs(),i.abs()).mul(n))},t.prototype.equals_tolerance=function(e,n){return this.eq_tolerance(e,n)},t.prototype.neq_tolerance=function(e,n){return!this.eq_tolerance(e,n)},t.prototype.notEquals_tolerance=function(e,n){return this.neq_tolerance(e,n)},t.prototype.lt_tolerance=function(e,n){var i=l(e);return!this.eq_tolerance(i,n)&&this.lt(i)},t.prototype.lte_tolerance=function(e,n){var i=l(e);return this.eq_tolerance(i,n)||this.lt(i)},t.prototype.gt_tolerance=function(e,n){var i=l(e);return!this.eq_tolerance(i,n)&&this.gt(i)},t.prototype.gte_tolerance=function(e,n){var i=l(e);return this.eq_tolerance(i,n)||this.gt(i)},t.prototype.log10=function(){return this.e+Math.log10(this.m)},t.prototype.absLog10=function(){return this.e+Math.log10(Math.abs(this.m))},t.prototype.pLog10=function(){return this.m<=0||this.e<0?0:this.log10()},t.prototype.log=function(e){return Math.LN10/Math.log(e)*this.log10()},t.prototype.log2=function(){return 3.321928094887362*this.log10()},t.prototype.ln=function(){return 2.302585092994045*this.log10()},t.prototype.logarithm=function(e){return this.log(e)},t.prototype.pow=function(e){var n,i=e instanceof t?e.toNumber():e,r=this.e*i;if(Number.isSafeInteger(r)&&(n=Math.pow(this.m,i),isFinite(n)&&n!==0))return E(n,r);var c=Math.trunc(r),m=r-c;if(n=Math.pow(10,i*Math.log10(this.m)+m),isFinite(n)&&n!==0)return E(n,c);var p=t.pow10(i*this.absLog10());return this.sign()===-1?Math.abs(i%2)===1?p.neg():Math.abs(i%2)===0?p:new t(Number.NaN):p},t.prototype.pow_base=function(e){return l(e).pow(this)},t.prototype.factorial=function(){var e=this.toNumber()+1;return t.pow(e/Math.E*Math.sqrt(e*Math.sinh(1/e)+1/(810*Math.pow(e,6))),e).mul(Math.sqrt(2*Math.PI/e))},t.prototype.exp=function(){var e=this.toNumber();return-706<e&&e<709?t.fromNumber(Math.exp(e)):t.pow(Math.E,e)},t.prototype.sqr=function(){return E(Math.pow(this.m,2),2*this.e)},t.prototype.sqrt=function(){return this.m<0?new t(Number.NaN):this.e%2!=0?E(3.16227766016838*Math.sqrt(this.m),Math.floor(this.e/2)):E(Math.sqrt(this.m),Math.floor(this.e/2))},t.prototype.cube=function(){return E(Math.pow(this.m,3),3*this.e)},t.prototype.cbrt=function(){var e=1,n=this.m;n<0&&(e=-1,n=-n);var i=e*Math.pow(n,1/3),r=this.e%3;return E(r===1||r===-1?2.154434690031883*i:r!==0?4.641588833612778*i:i,Math.floor(this.e/3))},t.prototype.sinh=function(){return this.exp().sub(this.negate().exp()).div(2)},t.prototype.cosh=function(){return this.exp().add(this.negate().exp()).div(2)},t.prototype.tanh=function(){return this.sinh().div(this.cosh())},t.prototype.asinh=function(){return t.ln(this.add(this.sqr().add(1).sqrt()))},t.prototype.acosh=function(){return t.ln(this.add(this.sqr().sub(1).sqrt()))},t.prototype.atanh=function(){return this.abs().gte(1)?Number.NaN:t.ln(this.add(1).div(new t(1).sub(this)))/2},t.prototype.ascensionPenalty=function(e){return e===0?this:this.pow(Math.pow(10,-e))},t.prototype.egg=function(){return this.add(9)},t.prototype.lessThanOrEqualTo=function(e){return this.cmp(e)<1},t.prototype.lessThan=function(e){return this.cmp(e)<0},t.prototype.greaterThanOrEqualTo=function(e){return this.cmp(e)>-1},t.prototype.greaterThan=function(e){return this.cmp(e)>0},t.prototype.decimalPlaces=function(){return this.dp()},t.prototype.dp=function(){if(!isFinite(this.mantissa))return NaN;if(this.exponent>=17)return 0;for(var e=this.mantissa,n=-this.exponent,i=1;Math.abs(Math.round(e*i)/i-e)>1e-10;)i*=10,n++;return n>0?n:0},Object.defineProperty(t,"MAX_VALUE",{get:function(){return Te},enumerable:!1,configurable:!0}),Object.defineProperty(t,"MIN_VALUE",{get:function(){return Me},enumerable:!1,configurable:!0}),Object.defineProperty(t,"NUMBER_MAX_VALUE",{get:function(){return qe},enumerable:!1,configurable:!0}),Object.defineProperty(t,"NUMBER_MIN_VALUE",{get:function(){return $e},enumerable:!1,configurable:!0}),t}(),Te=P(1,N),Me=P(1,-N),qe=l(Number.MAX_VALUE),$e=l(Number.MIN_VALUE);const w={autoFry:{name:"AutoFry",img:"Research1-Autofry.png",description:"AI-controlled sausage fryer.",cost:10,duration:30,effectAmount:1,effect:t=>{t.korv+=1,t.korv>t.korvtak&&(t.korv=t.korvtak)},effectInterval:5e3,criteria:t=>t.korv>=10,toggleable:"autoFryActive"},plasticBox:{name:"Plastlåda",img:"Research2-plastlada varmkorv.png",description:"Old laundry-box with several compartments.",cost:100,duration:60,criteria:t=>t.korv>=100,effect:t=>{t.korvtak+=900,t.equipment.plasticBox.unlocked=!0}},fishBox:{name:"Fisklåda",img:"Research3-fisklåda.png",description:"Upgrade the laundry box with a freezing water compartment",cost:750,duration:300,criteria:t=>t.korv>=750,effect:t=>{t.korvtak+=6350,t.equipment.fishBox.unlocked=!0}},condimentsMachine:{name:"Condiments Machine",img:"Research4-Condimentmachine.png",description:"A machine that applies condiments to sausages. Faster, more powerful and accurate than any human.",cost:1500,duration:360,effectAmount:50,toggleable:"condimentsMachineActive",criteria:t=>t.recipes.recipe2?.completed===!0,effectInterval:1e3,effect:t=>{t.condimentsMachineActive&&(t.korv+=50,t.korv>t.korvtak&&(t.korv=t.korvtak))}}},ie={recipe1:{name:"Recipe for sausage with ketchup and mustard.",description:"Esoteric knowledge concerning ancient sausage techniques. It seems to be over 400 years old.",img:"src/game/Assets/img/recept/recipe-frame-0-.png",cost:750,duration:60},recipe2:{name:"Recipe for sausage with everything on it.",description:"Esoteric knowledge concerning secret sausage techniques. It seems to be over 70 years old.",img:"src/game/Assets/img/recept/recipe-frame-0-.png",cost:1,duration:10}},S={lagerhus:{name:"Lagerhus",img:"src/game/Assets/img/building/building 1 - lagerhus.png",effectDescription:"Storage house for your cold dogs.",itemDescription:"Storage house for your cold dogs",baseCost:1e3,growthRate:1.1,duration:5,effect:t=>{t.korvtak+=1e3}}},o={korv:0,korvtak:250,research:{},equipment:{plasticBox:{unlocked:!1,equipped:!1},fishBox:{unlocked:!1,equipped:!1},korv1:{unlocked:!1,equipped:!1},korv2:{unlocked:!1,equipped:!1},korv3:{unlocked:!1,equipped:!1},allowedKorvWeapons:[],ketchup:{unlocked:!1,equipped:!1},senap:{unlocked:!1,equipped:!1},bostongurka:{unlocked:!1,equipped:!1},topphatt:{unlocked:!1,equipped:!1},pilgrimshatt:{unlocked:!1,equipped:!1},equippedPrimary:null,equippedSecondary:null},boogie:{maxHP:3,currentHP:1,baseRegen:1/60,regenBonuses:{flat:0},damageTypes:{},attackPower:0,defense:0,statusEffects:[],defeatedEnemies:new Set},skills:{throw:{unlocked:!1,level:1}},recipes:{},buildings:{},autoFryActive:!1,condimentsMachineActive:!1};for(const t in w)o.research[t]={unlocked:!1,researching:!1,remainingTime:w[t].duration,completed:!1,_accumulator:0};for(const t in ie)o.recipes[t]={unlocked:!1,crafting:!1,remainingTime:0,completed:!1};for(const t in S)o.buildings[t]={unlocked:!1,constructing:!1,remainingTime:S[t].duration,completed:!1};function Ce(){o.korv===void 0&&(o.korv=0),o.korv<o.korvtak?(o.korv+=1,Q(o.korv)):console.log("Korvtak reached! No more korv can be added.")}function Ne(){o.korv===void 0&&(o.korv=0),o.korv<o.korvtak?(o.korv+=10,Q(o.korv)):console.log("Korvtak reached! No more korv can be added.")}function Se(){o.korv===void 0&&(o.korv=0),o.korv<o.korvtak?(o.korv+=50,Q(o.korv)):console.log("Korvtak reached! No more korv can be added.")}function Ae(){o.korv+=1e3,o.korv>o.korvtak&&(o.korv=o.korvtak)}const de={korv1:{name:"Cooked hot dog",description:"One generic sausage.",img:"src/game/Assets/img/equipment/Korvknappar/korv1.png"},korv2:{name:"Cooked hot dog with ketchup and mustard",description:"This one has taste!",img:"src/game/Assets/img/equipment/Korvknappar/korv2.png"},korv3:{name:"Cooked hot dog with everything",description:"The pinnacle of swedish ingenuity!",img:"src/game/Assets/img/equipment/Korvknappar/korv3.png"},fuskkorv:{name:"The one doG",description:"The Gods use this to test the limits of their Realm.",img:"src/game/Assets/img/equipment/Korvknappar/korv1.png"}};function De({tabContent:t,mainScreen:e,infoLeft:n,infoRight:i}){const r=document.getElementById("mainscreen-centering");r&&r.remove();const c=document.createElement("div");c.id="mainscreen-centering",c.style.display="flex",c.style.justifyContent="center",c.style.alignItems="flex-start",c.style.height="100%",c.style.width="100%";const m=document.createElement("div");m.id="mainscreen-wrapper",m.style.position="relative",m.style.width="740px",m.style.height="400px";const p=document.createElement("img");p.src=`${KorvkioskData.pluginUrl}src/game/Assets/img/kiosk/korvkioskmainscreen-inprogress.gif`,p.style.display="block",p.style.width="740px",p.style.height="400px",m.appendChild(p);const d=[];o.research.autoFry&&o.research.autoFry.unlocked&&!o.autoFryActive&&d.push(`${KorvkioskData.pluginUrl}src/game/Assets/img/kiosk/autofry.png`),o.autoFryActive&&d.push(`${KorvkioskData.pluginUrl}src/game/Assets/img/kiosk/autofryactive.gif`),d.forEach(a=>{const s=document.createElement("img");s.src=a,s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.width="740px",s.style.height="400px",s.style.pointerEvents="none",m.appendChild(s)}),c.appendChild(m),e.appendChild(c);const u=document.createElement("div");u.id="kiosk-container",u.style.display="flex",u.style.flexWrap="wrap",u.style.gap="10px",u.style.justifyContent="flex-start",u.style.alignItems="flex-start",u.style.padding="10px";for(const a in de){const s=de[a];if(a==="korv1"||a==="fuskkorv"||a==="korv2"&&o.recipes.recipe1?.completed||a==="korv3"&&o.recipes.recipe2?.completed){const g=document.createElement("button");g.type="button",g.className="kiosk-button",g.innerHTML=`
        <img src="${KorvkioskData.pluginUrl}${s.img}" 
             alt="${s.name}" style="width:64px; height:64px;">
      `,a==="korv1"&&g.addEventListener("click",Ce),a==="korv2"&&g.addEventListener("click",Ne),a==="korv3"&&g.addEventListener("click",Se),a==="fuskkorv"&&g.addEventListener("click",Ae),g.addEventListener("mouseenter",()=>{n&&(n.innerHTML=`
          <div style="text-align: center;">
            <div style="font-size: 20px; font-weight: bold; text-decoration: underline; color: black;">
              ${s.name}
            </div>
            <div style="margin-top: 8px; font-size: 16px;">
              ${s.description}
            </div>
          `)}),g.addEventListener("mouseleave",()=>{n&&(n.innerHTML="")}),u.appendChild(g)}}t.appendChild(u);function f(){if(!i)return;let a=0;for(const s in w){const g=w[s];g.toggleable&&o[g.toggleable]&&g.effectAmount&&g.effectInterval&&(a+=g.effectAmount/(g.effectInterval/1e3))}i.innerHTML=`
      <div style="font-size: 18px; font-weight: bold; margin-bottom: 10px;">Kiosk Stats</div>
      <div>Passive Income: ${a.toFixed(2)} korv/sec</div>
    `}return f(),q(f),()=>{A(f)}}const ae=new Set;let pe=Date.now();setInterval(()=>{const t=Date.now(),e=t-pe;pe=t,ae.forEach(n=>{try{n(e)}catch(i){console.error("Error in gameLoop update:",i)}})},1e3/30);function D(t){ae.add(t)}function fe(t){ae.delete(t)}let j=!1,F=null;function He(){for(const t in w){const e=w[t],n=o.research[t];!n.unlocked&&e.criteria(o)&&(n.unlocked=!0,console.log(`${e.name} unlocked!`))}}function Ie(t){const e=o.research[t],n=w[t];if(!(!e||!n)&&!e.researching&&!e.completed){if(o.korv<n.cost){console.log(`Not enough korv to start ${n.name} research!`);return}o.korv-=n.cost,e.researching=!0,e.remainingTime=n.duration,e.lastUpdated=Date.now(),console.log(`${n.name} research started! ${n.cost} korv deducted.`),j||(F=i=>le(i),D(F),j=!0)}}function le(t){const e=t/1e3;let n=!1;for(const i in o.research){const r=o.research[i],c=w[i];r.researching&&!r.completed&&(n=!0,r.remainingTime-=e,r.remainingTime<=0&&(r.remainingTime=0,r.researching=!1,r.completed=!0,console.log(`${c.name} research complete!`),!c.toggleable&&typeof c.effect=="function"&&c.effect(o)))}!n&&j&&(fe(F),j=!1,F=null)}function _e(){let t=!1;for(const e in o.research){const n=o.research[e],i=w[e];if(n.researching&&!n.completed){typeof n.lastUpdated!="number"&&(n.lastUpdated=Date.now());const r=Date.now(),c=Math.floor((r-n.lastUpdated)/1e3);if(c>0&&(n.remainingTime-=c,n.remainingTime<=0)){n.remainingTime=0,n.researching=!1,n.completed=!0,console.log(`${i.name} research complete on load!`),!i.toggleable&&typeof i.effect=="function"&&i.effect(o);continue}n.lastUpdated=r,t=!0}}t&&!j&&(F=e=>le(e),D(F),j=!0)}function Ue(t){for(const e in w){const n=w[e],i=o.research[e];if(i.completed&&!(!n.effectInterval||typeof n.effect!="function")&&!(n.toggleable&&!o[n.toggleable]))for(i._accumulator+=t;i._accumulator>=n.effectInterval;)i._accumulator-=n.effectInterval,n.effect(o)}}function Pe(){console.log("Cheat: setting all active research timers to 1 second left");for(const t in o.research){const e=o.research[t];e.researching&&!e.completed&&(e.remainingTime=1,e.lastUpdated=Date.now(),console.log(`${t} set to 1 second remaining`))}}function Le(t){le(t),Ue(t)}let B=null;const ee=new Map;function Be({tabContent:t,mainScreen:e,infoLeft:n,infoRight:i}){e.innerHTML=`
    <div style="display:flex; justify-content:center; align-items:center; height:100%;">
      <img src="${KorvkioskData.pluginUrl}src/game/Assets/img/research/researchmainscreen.gif"
           style="max-height:auto; max-width:auto;">
    </div>
  `,t.innerHTML="",n&&(n.innerHTML=""),i&&(i.innerHTML='<div style="font-size:18px; font-weight:bold;">Active Research</div>'),He(),ee.clear();const r=document.createElement("div");r.id="research-container",r.style.display="flex",r.style.flexWrap="wrap",r.style.gap="10px",r.style.justifyContent="flex-start",r.style.alignItems="flex-start",r.style.padding="10px";function c(u,f){if(!i)return;let a=document.getElementById(`timer-${u}`);a||(a=document.createElement("div"),a.id=`timer-${u}`,a.style.fontSize="14px",a.style.marginTop="4px",i.appendChild(a));const s=w[u].name||u;a.textContent=`${s}: ${Math.ceil(f)}s`}function m(u){const f=document.getElementById(`timer-${u}`);f&&f.remove()}function p(u){const f=o.research[u],a=w[u];if(!f.unlocked)return null;const s=document.createElement("button");s.type="button",s.className="kiosk-button",s.innerHTML=`
      <img src="${KorvkioskData.pluginUrl}src/game/Assets/img/research/${a.img}" 
           alt="${a.name}" 
           style="width:64px; height:64px;">
    `;const g=document.createElement("div");g.style.position="absolute",g.style.bottom="-20px",g.style.width="100%",g.style.textAlign="center",g.style.fontSize="14px",s.style.position="relative",s.appendChild(g);function h(){if(f.researching)s.disabled=!0,s.style.opacity="0.5",g.textContent=`${Math.ceil(f.remainingTime)}s`,c(u,f.remainingTime);else if(!f.completed)s.disabled=!1,s.style.opacity="0.5",g.textContent=`${a.duration}s`,m(u);else{const y=a.toggleable;s.disabled=!1,y?(s.style.opacity=o[y]?"1":"0.5",g.textContent=o[y]?"ON":"OFF"):(s.style.opacity="0.5",g.textContent="✓"),m(u)}}return s.addEventListener("mouseenter",()=>{n&&(n.innerHTML=`
          <div style="text-align: center;">
            <div style="font-size: 20px; font-weight: bold; text-decoration: underline;">
              ${a.name}
            </div>
            <div style="margin-top: 8px; font-size: 16px;">
              ${a.description||"No description yet."}
            </div>
            <div style="margin-top: 8px; font-size: 14px;">
              Duration: ${a.duration}s
            </div>
          </div>
        `)}),s.addEventListener("mouseleave",()=>{n&&(n.innerHTML="")}),s.addEventListener("click",()=>{!f.researching&&!f.completed?Ie(u):f.completed&&a.toggleable&&(o[a.toggleable]=!o[a.toggleable]),h()}),ee.set(u,h),h(),s}for(const u in w){const f=p(u);f&&r.appendChild(f)}const d=document.createElement("button");return d.type="button",d.id="finishResearchButton",d.textContent="Finish Research",d.className="kiosk-button",d.style.width="120px",d.style.height="40px",d.style.fontSize="14px",d.addEventListener("click",Pe),r.appendChild(d),t.appendChild(r),B=()=>{ee.forEach(u=>u());for(const u in o.research){const f=o.research[u];f.researching&&!f.completed?c(u,f.remainingTime):m(u)}},D(B),B(),()=>{B&&(fe(B),B=null),ee.clear()}}function $(t,e){t.boogie.damageTypes[e]=(t.boogie.damageTypes[e]||0)+1}function C(t,e){t.boogie.damageTypes[e]&&(t.boogie.damageTypes[e]--,t.boogie.damageTypes[e]<=0&&delete t.boogie.damageTypes[e])}const b={plasticBox:{name:"Plastlåda",img:"src/game/Assets/img/equipment/korvlador/Korvlada1-plastladavarmkorv.png",effectDescription:"Can cook some basic sausage types.",itemDescription:"An old laundry box repurposed for sausage creation. The boiling water smells like detergent.",slot:"korvBox",toggleable:null,onEquip:t=>{t.equipment.korv1.unlocked||(t.equipment.korv1.unlocked=!0,console.log("Kokt korv med bröd (korv1) unlocked!")),t.equipment.allowedKorvWeapons=["korv1","korv2","korv3"]},onUnequip:null},fishBox:{name:"Fisklåda",img:"src/game/Assets/img/research/Research3-fisklåda.png",effectDescription:"Makes sausages edible by freezing.",itemDescription:"An unlocked freezing compartment in the old laundry box. Who put this there?",slot:"korvBox",toggleable:null,onEquip:t=>{t.equipment.allowedKorvWeapons=["korv1","korv2","korv3"],$(t,"cold")},onUnequip:t=>{C(t,"cold")}},korv1:{name:"Kokt korv med bröd",img:"src/game/Assets/img/equipment/Korvknappar/korv1.png",slot:"primaryHand",effectDescription:"A basic sausage with nothing on it.",itemDescription:"A lukewarm sausage in mushy bread. No condiments.",toggleable:!0,unlocked:!1,equipped:!1,onEquip:t=>{$(t,"normal"),t.boogie.attackPower+=1},onUnequip:t=>{C(t,"normal"),t.boogie.attackPower-=1}},korv2:{name:"Kokt korv med bröd, ketchup och senap",img:"src/game/Assets/img/equipment/Primary Hand/primaryhand 2 - kokt korv med bröd,ketchup,senap.png",slot:"primaryHand",effectDescription:"A sausage with ketchup and mustard on it.",itemDescription:"A lukewarm sausage in mushy bread with ketchup and mustard on it.",toggleable:!0,unlocked:!1,equipped:!1,onEquip:t=>{$(t,"normal"),$(t,"heat"),$(t,"pungent"),t.boogie.attackPower+=2},onUnequip:t=>{C(t,"normal"),C(t,"heat"),C(t,"pungent"),t.boogie.attackPower-=2}},korv3:{name:"Kokt korv med allt",img:"src/game/Assets/img/equipment/Primary Hand/primaryhand 3 - kokt korv med bröd alla ingredienser.png",slot:"primaryHand",effectDescription:"A sausage with everything on it.",itemDescription:"A lukewarm sausage in mushy bread with everything on it.",toggleable:!0,unlocked:!1,equipped:!1,onEquip:t=>{$(t,"normal"),$(t,"heat"),$(t,"pungent"),t.boogie.attackPower+=3},onUnequip:t=>{C(t,"normal"),C(t,"heat"),C(t,"pungent"),t.boogie.attackPower-=3}},ketchup:{name:"Phoenix Ketchup ",img:"src/game/Assets/img/equipment/Secondary hand/Secondary hand 1 - ketchup.png",slot:"secondaryHand",effectDescription:"Adds heat to the sausage.",itemDescription:"The Thin Red Line.",toggleable:!0,onEquip:t=>{$(t,"heat")},onUnequip:t=>{C(t,"heat")}},senap:{name:"Senap",img:"src/game/Assets/img/equipment/Secondary hand/Secondary hand 2 - senap.png",slot:"secondaryHand",effectDescription:"Adds a pungent taste to the sausage.",itemDescription:"Castle-grade mustard.",toggleable:!0,onEquip:t=>{$(t,"pungent")},onUnequip:t=>{C(t,"pungent")}},bostongurka:{name:"Phoenix Bostongurka",img:"src/game/Assets/img/equipment/Secondary hand/Secondary hand 3 - bostongurka.png",slot:"secondaryHand",effectDescription:"Adds a revitalizing taste to the sausage.",itemDescription:"Agurken straight outta Boston.",toggleable:!0,onEquip:t=>{t.boogie.regenBonuses.bostongurka=1/5},onUnequip:t=>{delete t.boogie.regenBonuses.bostongurka}},topphatt:{name:"Topphatt",img:"src/game/Assets/img/equipment/Hatt/Hatt 1 - Topphatt.png",slot:"hatt",effectDescription:"Covers your ears somewhat from bullshit.",itemDescription:"The top of the crop of hats. Now we are talking!",toggleable:!0,onEquip:t=>{t.boogie.maxHP+=10},onUnequip:t=>{t.boogie.maxHP-=10}},pilgrimshatt:{name:"Pilgrimshatt",img:"src/game/Assets/img/equipment/Hatt/Hatt 2 - Pilgrimshatt.png",slot:"hatt",effectDescription:"Shield yourself from bullshit with your own bullshit.",itemDescription:"In pristine condition, almost as if it blesse by some entity.",toggleable:!0,onEquip:t=>{t.boogie.maxHP+=50},onUnequip:t=>{t.boogie.maxHP-=50}}};let U=null,z=null;function Ke(t,e,n,i,r){const c=o.equipment[t],m=b[t];if(!c||!c.unlocked)return null;const p=document.createElement("button");p.type="button",p.dataset.equipmentKey=t,p.style.width="64px",p.style.height="64px",p.style.position="relative",p.style.border="none",p.style.padding="0",p.style.cursor="pointer",p.className="kiosk-button";const d=document.createElement("img");d.src=`${KorvkioskData.pluginUrl}${m.img}`,d.style.width="64px",d.style.height="64px",d.style.display="block",d.style.transition="opacity 0.2s",p.appendChild(d),m.effectDescription&&(p.title=m.effectDescription),p.addEventListener("mouseenter",()=>{i&&(i.innerHTML=`
        <div style="font-size:20px; font-weight:bold; text-decoration:underline;">${m.name}</div>
        <div style="text-align: center;">${m.itemDescription||"No description available"}</div>
      `)}),p.addEventListener("mouseleave",()=>{i&&(i.innerHTML='<div style="text-align: center;">Hover over an item for information</div>')});function u(){if(!r)return;const s=o.boogie,g=s.damageTypes?Object.keys(s.damageTypes).filter(y=>s.damageTypes[y]>0):[],h=g.length>0?g.join(", "):"None";r.innerHTML=`
    <div style="
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: flex-start;
      height: 100%;
      text-align: left;
    ">
      <div>HP: ${Math.floor(s.currentHP)} / ${Math.floor(s.maxHP)}</div>
      <div>Attack: ${s.attackPower}</div>
      <div>Defense: ${s.defense}</div>
      <div>Damage Types: ${h}</div>
      <div>Status Effects: ${s.statusEffects.length>0?s.statusEffects.join(", "):"None"}</div>
    </div>
  `}function f(){d.style.opacity=c.equipped?"1":"0.4"}function a(){const s=document.querySelector(`#slot-${m.slot} img`);s&&(c.equipped?(s.src=`${KorvkioskData.pluginUrl}${m.img}`,s.style.opacity="1"):(s.src=`${KorvkioskData.pluginUrl}src/game/Assets/img/boogie/duelframe0.png`,s.style.opacity="0.5"))}return f(),a(),u(),p.addEventListener("click",()=>{if(c.equipped){c.equipped=!1,m.onUnequip&&m.onUnequip(o),f(),a(),u();return}for(const s in b){const g=o.equipment[s];if(g&&g.equipped&&b[s].slot===m.slot){g.equipped=!1,b[s].onUnequip&&b[s].onUnequip(o);const h=document.querySelector(`#slot-${b[s].slot} img`);h&&(h.src=`${KorvkioskData.pluginUrl}src/game/Assets/img/boogie/duelframe0.png`,h.style.opacity="0.5");const y=document.querySelector(`button[data-equipment-key="${s}"] img`);y&&(y.style.opacity="0.4")}}c.equipped=!0,t==="korv1"&&o.skills&&!o.skills.throw?.unlocked&&(o.skills.throw?o.skills.throw.unlocked=!0:o.skills.throw={unlocked:!0,level:1}),m.onEquip&&m.onEquip(o),f(),a(),u()}),p}function me(t,e,n,i,r,c){e.innerHTML="";for(const m in b){const p=b[m],d=o.equipment[m];if(!d||!d.unlocked||p.slot!==t)continue;const u=Ke(m,n,i,r,c);u&&e.appendChild(u)}}function je({tabContent:t,mainScreen:e,infoLeft:n,infoRight:i,categoryOverride:r=null}){e.innerHTML="",t.innerHTML="",i||(i=document.createElement("div"),i.id="equipment-info-right",i.style.border="1px solid #444",i.style.padding="8px",i.style.minWidth="150px",t.appendChild(i));const c=document.createElement("div");c.style.width="740px",c.style.height="400px",c.style.display="grid",c.style.gridTemplateColumns="repeat(4, 1fr)",c.style.justifyItems="center",c.style.alignItems="center",c.style.gap="20px",c.style.border="solid";const m=document.createElement("div");m.style.width="100%",m.style.height="100%",m.style.display="flex",m.style.justifyContent="center",m.style.alignItems="center",m.appendChild(c),e.appendChild(m);const p=[{name:"Primary Hand",key:"primaryHand"},{name:"Secondary Hand",key:"secondaryHand"},{name:"Hatt",key:"hatt"},{name:"Korvlåda",key:"korvBox"}];p.forEach(a=>{const s=document.createElement("div");s.id=`slot-${a.key}`,s.style.display="flex",s.style.flexDirection="column",s.style.alignItems="center";const g=document.createElement("p");g.textContent=a.name,g.style.margin="0 0 8px 0",g.style.fontWeight="bold",s.appendChild(g);const h=document.createElement("img");h.alt=a.name,h.style.width="64px",h.style.height="64px",h.style.border="2px solid #444",h.style.borderRadius="8px";let y=Object.keys(o.equipment).find(v=>o.equipment[v]?.equipped&&b[v]?.slot===a.key);y?(h.src=`${KorvkioskData.pluginUrl}${b[y].img}`,h.style.opacity="1"):(h.src=`${KorvkioskData.pluginUrl}src/game/Assets/img/boogie/duelframe0.png`,h.style.opacity="0.5"),s.appendChild(h),c.appendChild(s)});function d(){for(const a of p){const s=document.querySelector(`#slot-${a.key} img`);if(!s)continue;const g=Object.keys(o.equipment).find(h=>o.equipment[h]?.equipped&&b[h]?.slot===a.key);g?(s.src=`${KorvkioskData.pluginUrl}${b[g].img}`,s.style.opacity="1"):(s.src=`${KorvkioskData.pluginUrl}src/game/Assets/img/boogie/duelframe0.png`,s.style.opacity="0.5")}}U||(U=p[0].key),r&&(U=r);const u=document.createElement("div");u.style.display="flex",u.style.justifyContent="space-around",u.style.alignItems="flex-start",u.style.height="40px",u.style.marginBottom="8px";const f=document.createElement("div");return f.style.display="flex",f.style.flexWrap="wrap",f.style.justifyContent="left",f.style.gap="5px",f.style.marginTop="1px",p.forEach(a=>{const s=document.createElement("button");s.type="button",s.textContent=a.name,s.style.flex="1",s.style.margin="0 5px",s.style.padding="8px",s.style.cursor="pointer",s.style.fontWeight=U===a.key?"bold":"normal",s.addEventListener("click",()=>{U=a.key,me(U,f,t,e,n,i),Array.from(u.children).forEach(g=>g.style.fontWeight="normal"),s.style.fontWeight="bold",d()}),u.appendChild(s)}),t.appendChild(u),t.appendChild(f),me(U,f,t,e,n,i),n&&(n.innerHTML="Select an item for info"),d(),z=()=>{for(const a in b){const s=b[a],g=document.querySelector(`#slot-${s.slot} img`);if(!g)continue;const h=Object.keys(o.equipment).find(y=>o.equipment[y]?.equipped&&b[y]?.slot===s.slot);h?(g.src=`${KorvkioskData.pluginUrl}${b[h].img}`,g.style.opacity="1"):(g.src=`${KorvkioskData.pluginUrl}src/game/Assets/img/boogie/duelframe0.png`,g.style.opacity="0.5")}if(i){const a=o.boogie,s=a.damageTypes?Object.keys(a.damageTypes).filter(h=>a.damageTypes[h]>0):[],g=s.length>0?s.join(", "):"None";i.innerHTML=`
        <div style="
          display: flex;
          flex-direction: column;
          justify-content: center;
          align-items: flex-start;
          height: 100%;
          text-align: left;
        ">
          <div>HP: ${Math.floor(a.currentHP)} / ${Math.floor(a.maxHP)}</div>
          <div>Attack: ${a.attackPower}</div>
          <div>Defense: ${a.defense}</div>
          <div>Damage Types: ${g}</div>
          <div>Status Effects: ${a.statusEffects.length>0?a.statusEffects.join(", "):"None"}</div>
        </div>
      `}},q(z),function(){z&&(A(z),z=null)}}const se={byråkrat:{name:"Byråkrat",img:"boogie 1 - byråkrat.png",description:"En byråkrat kommer med sitt prat.",unlockCondition:t=>t.equipment.korv1?.unlocked===!0,winCondition:t=>!!t.boogie.damageTypes.normal,drops:["ketchup","topphatt"],victoryUnlocks:["ärkekrat"]},ärkekrat:{name:"Ärkekrat",img:"boogie 2 -  ärkekrat.png",description:"Han kom gående på gaten.",unlockCondition:t=>t.boogie.defeatedEnemies.has("byråkrat"),winCondition:t=>!!t.boogie.damageTypes.heat&&!!t.boogie.damageTypes.cold,drops:["senap","recipe1"],victoryUnlocks:[]},överförmyndare:{name:"Överförmyndare",img:"boogie 3 - överförmyndare.png",description:"A man with a grim hat. He seems to hate the swedish cold weather and he seems to scoff at what swedish people call castles.",unlockCondition:t=>t.boogie.defeatedEnemies.has("ärkekrat"),winCondition:t=>!!t.boogie.damageTypes.cold&&!!t.boogie.damageTypes.pungent,drops:["bostongurka","recipe2","pilgrimshatt","lagerhus"],victoryUnlocks:[]}};let K=null,te=null;function ge({tabContent:t,mainScreen:e,infoLeft:n,infoRight:i}){o.boogie?Array.isArray(o.boogie.defeatedEnemies)?o.boogie.defeatedEnemies=new Set(o.boogie.defeatedEnemies):o.boogie.defeatedEnemies&&o.boogie.defeatedEnemies.__type==="Set"?o.boogie.defeatedEnemies=new Set(o.boogie.defeatedEnemies.values||[]):o.boogie.defeatedEnemies instanceof Set||(o.boogie.defeatedEnemies=new Set):o.boogie={defeatedEnemies:new Set,damageTypes:new Set,statusEffects:[],maxHP:3,currentHP:3,attackPower:0,defense:0},t.innerHTML="";const r=document.createElement("div");r.style.display="flex",r.style.flexWrap="wrap",r.style.gap="10px",r.style.justifyContent="flex-start",r.style.alignItems="flex-start",r.style.padding="10px";function c(){typeof te=="function"&&(te(),te=null),ge({tabContent:t,mainScreen:e,infoLeft:n,infoRight:i})}for(const p in se){const d=se[p];try{if(!d.unlockCondition(o))continue}catch(f){console.error(`Error evaluating unlockCondition for ${p}:`,f);continue}const u=document.createElement("button");u.type="button",u.className="kiosk-button",u.innerHTML=`
      <img src="${KorvkioskData.pluginUrl}src/game/Assets/img/boogie/${d.img}" 
           alt="${d.name}" 
           style="width:64px; height:64px;">
    `,u.addEventListener("mouseenter",()=>{n&&(n.innerHTML=`
          <div style="text-align:center;">
            <div style="font-size:20px; font-weight:bold; text-decoration:underline;">
              ${d.name}
            </div>
            <div style="margin-top:8px; font-size:16px;">
              ${d.description}
            </div>
          </div>
        `)}),u.addEventListener("mouseleave",()=>{n&&(n.innerHTML="")}),u.addEventListener("click",()=>{let f=!1;try{f=!!d.winCondition(o)}catch(a){console.error(`Error evaluating winCondition for ${p}:`,a),f=!1}f?(console.log(`You defeated ${d.name}!`),(!o.boogie.defeatedEnemies||!(o.boogie.defeatedEnemies instanceof Set))&&(o.boogie.defeatedEnemies=new Set(o.boogie.defeatedEnemies||[])),o.boogie.defeatedEnemies.add(p),(d.drops||[]).forEach(a=>{o.equipment?.[a]&&!o.equipment[a].unlocked?(o.equipment[a].unlocked=!0,console.log(`${a} unlocked!`)):o.recipes?.[a]&&!o.recipes[a].unlocked?(o.recipes[a].unlocked=!0,console.log(`${a} recipe unlocked!`)):o.buildings?.[a]&&!o.buildings[a].unlocked&&(o.buildings[a].unlocked=!0,console.log(`${a} building unlocked!`))}),d.victoryUnlocks&&d.victoryUnlocks.forEach(a=>{const s=se[a];s&&console.log(`New enemy unlocked: ${s.name}`)}),c()):console.log(`You cannot defeat ${d.name} yet. Equip the right damage type.`)}),r.appendChild(u)}t.appendChild(r),i&&(!i.innerHTML||i.innerHTML.trim()==="")&&(i.innerHTML='<div style="font-size:18px; font-weight:bold;">Boogie Stats</div>'),K=()=>{if(!i)return;const p=o.boogie?.damageTypes?Object.keys(o.boogie.damageTypes).filter(u=>o.boogie.damageTypes[u]>0):[],d=p.length>0?p.join(", "):"None";i.innerHTML=`
      <div style="
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: flex-start;
        height: 100%;
        text-align: left;
      ">
        <div>HP: ${Math.floor(o.boogie?.currentHP??0)} / ${Math.floor(o.boogie?.maxHP??0)}</div>
        <div>Attack: ${o.boogie?.attackPower??0}</div>
        <div>Defense: ${o.boogie?.defense??0}</div>
        <div>Damage Types: ${d}</div>
        <div>Status Effects: ${Array.isArray(o.boogie?.statusEffects)&&o.boogie.statusEffects.length>0?o.boogie.statusEffects.join(", "):"None"}</div>
      </div>
    `},q(K);function m(){K&&(A(K),K=null)}return te=m,K(),m}const Fe={throw:{name:"Throw",img:"Skill 1 - Throw.png",description:"Throw the sausage very hard."}};let O=null;function ze({tabContent:t,mainScreen:e,infoLeft:n,infoRight:i}){t.innerHTML="",n&&(n.innerHTML=""),i&&(i.innerHTML='<div style="font-size:18px; font-weight:bold;">Unlocked Skills To be changed</div>');const r=document.createElement("div");t.appendChild(r);for(const[c,m]of Object.entries(o.skills)){if(!m.unlocked)continue;const p=Fe[c];if(!p)continue;const d=document.createElement("button");d.type="button",d.className="kiosk-button",d.innerHTML=`
      <img src="${KorvkioskData.pluginUrl}src/game/Assets/img/skills/${p.img}" 
           alt="${p.name}" 
           style="width:64px; height:64px;">
    `,d.addEventListener("mouseenter",()=>{n&&(n.innerHTML=`
          <div style="text-align: center;">
            <div style="font-size: 20px; font-weight: bold; text-decoration: underline;">
              ${p.name}
            </div>
            <div style="margin-top: 8px; font-size: 16px;">
              ${p.description}
            </div>
            <div style="margin-top: 8px;">Level: ${m.level}</div>
          </div>
        `)}),d.addEventListener("mouseleave",()=>{n&&(n.innerHTML="")}),r.appendChild(d)}if(r.children.length===0){const c=document.createElement("p");c.textContent="No skills unlocked yet!",c.style.textAlign="center",t.appendChild(c)}return O=()=>{},q(O),function(){O&&(A(O),O=null)}}function Oe(t){const e=o.recipes[t],n=ie[t];!e||!n||e.crafting||e.completed||(e.crafting=!0,e.remainingTime=n.duration)}function Re(t){const e=t/1e3;for(const n in o.recipes){const i=o.recipes[n];i.crafting&&(i.remainingTime-=e,i.remainingTime<=0&&(i.remainingTime=0,i.crafting=!1,i.completed=!0,We(n)))}}function We(t){t==="recipe1"&&(o.equipment.korv2.unlocked=!0,o.kiosk?.korv2&&(o.kiosk.korv2.unlocked=!0)),t==="recipe2"&&(o.equipment.korv3.unlocked=!0,o.kiosk?.korv3&&(o.kiosk.korv3.unlocked=!0))}let R=null;function Ve({tabContent:t,mainScreen:e,infoLeft:n,infoRight:i}){e.innerHTML=`
    <div style="display:flex; justify-content:center; align-items:center; height:100%;">
      <img src="${KorvkioskData.pluginUrl}src/game/Assets/img/recept/recipesmainscreen.png"
           style="max-height:auto; max-width:auto;">
    </div>
  `,t.innerHTML="",n&&(n.innerHTML=""),i&&(i.innerHTML='<div style="font-size:18px; font-weight:bold;">Active Recipes</div>');const r=document.createElement("div");r.id="recipe-container",t.appendChild(r);const c=new Map;function m(p){const d=o.recipes[p],u=ie[p];if(!d.unlocked)return null;const f=document.createElement("button");f.type="button",f.className="kiosk-button",f.style.position="relative",f.style.margin="5px",f.innerHTML=`
      <img src="${KorvkioskData.pluginUrl}${u.img}" 
           alt="${u.name}" 
           style="width:64px; height:64px;">
    `;const a=document.createElement("div");a.style.position="absolute",a.style.bottom="-20px",a.style.width="100%",a.style.textAlign="center",a.style.fontSize="14px",f.appendChild(a);function s(){if(d.crafting){f.disabled=!0,f.style.opacity="0.5";const y=Math.ceil(d.remainingTime);a.textContent=`${y}s`,g(p,y)}else d.completed?(f.disabled=!0,f.style.opacity="0.5",a.textContent="✓",h(p)):(f.disabled=!1,f.style.opacity="1",a.textContent=`${u.cost} korv`,h(p))}f.addEventListener("mouseenter",()=>{n&&(n.innerHTML=`
          <div style="text-align: center;">
            <div style="font-size: 20px; font-weight: bold; text-decoration: underline;">
              ${u.name}
            </div>
            <div style="margin-top: 8px; font-size: 16px;">
              ${u.description||"No description yet."}
            </div>
            <div style="margin-top: 8px; font-size: 14px;">
              Cost: ${u.cost} korv<br>
              Duration: ${u.duration}s
            </div>
          </div>
        `)}),f.addEventListener("mouseleave",()=>{n&&(n.innerHTML="")}),f.addEventListener("click",()=>{o.korv>=u.cost&&!d.crafting&&!d.completed&&(o.korv-=u.cost,Oe(p),s())});function g(y,v){if(!i)return;let k=document.getElementById(`recipe-timer-${y}`);k||(k=document.createElement("div"),k.id=`recipe-timer-${y}`,k.style.fontSize="14px",k.style.marginTop="4px",i.appendChild(k));const H=u.name||y;k.textContent=`${H}: ${v}s`}function h(y){const v=document.getElementById(`recipe-timer-${y}`);v&&v.remove()}return c.set(p,s),s(),f}for(const p in ie){const d=m(p);d&&r.appendChild(d)}return R=()=>{for(const p in o.recipes){const d=c.get(p);d&&d()}},q(R),function(){R&&(A(R),R=null)}}function Ge(t){const e=o.buildings[t],n=S[t];!e||!n||e.constructing||(e.constructing=!0,e.remainingTime=n.duration)}function Ye(t){const e=t/1e3;for(const n in o.buildings){const i=o.buildings[n],r=S[n];i?.constructing&&(i.remainingTime-=e,i.remainingTime<=0&&(i.remainingTime=0,i.constructing=!1,i.count=(i.count||0)+1,r?.effect&&r.effect(o),console.log(`${n} constructed! Count: ${i.count}`)))}}let W=null;function Je({tabContent:t,mainScreen:e,infoLeft:n,infoRight:i}){const r=document.getElementById("mainscreen-centering");r&&r.remove();const c=document.createElement("div");c.id="mainscreen-centering",c.style.display="flex",c.style.justifyContent="center",c.style.alignItems="flex-start",c.style.height="100%",c.style.width="100%";const m=document.createElement("div");m.id="mainscreen-wrapper",m.style.position="relative",m.style.width="740px",m.style.height="400px";const p=document.createElement("img");p.src=`${KorvkioskData.pluginUrl}src/game/Assets/img/building/buildingmainscreen.png`,p.style.width="740px",p.style.height="400px",p.style.display="block",m.appendChild(p),c.appendChild(m),e.appendChild(c),t.innerHTML="",n&&(n.innerHTML=""),i&&(i.innerHTML='<div style="font-size:18px; font-weight:bold;">Active Constructions</div>');const d=document.createElement("div");d.id="building-container";function u(a){return a>=1e6?a.toExponential(2).replace("e+","E"):a.toLocaleString()}function f(a){const s=o.buildings[a],g=S[a];if(!s?.unlocked)return null;s.count===void 0&&(s.count=0);const h=document.createElement("button");h.className="kiosk-button",h.style.position="relative",h.style.margin="5px";const y=`${KorvkioskData.pluginUrl.replace(/\/$/,"")}/${g.img||"src/game/Assets/img/building/default.png"}`;h.innerHTML=`<img src="${y}" alt="${g.name}" style="width:64px; height:64px;">`;const v=document.createElement("div");v.style.position="absolute",v.style.bottom="-20px",v.style.width="100%",v.style.textAlign="center",v.style.fontSize="14px",h.appendChild(v);function k(){return Math.floor(g.baseCost*Math.pow(g.growthRate,s.count))}function H(){const T=k();if(s.constructing){h.disabled=!0,h.style.opacity="0.5";const I=Math.ceil(s.remainingTime);v.textContent=`${I}s`,ye(a,I)}else h.disabled=!1,h.style.opacity="1",v.textContent=`${u(T)} korv`,ve(a)}h.addEventListener("mouseenter",()=>{if(!n)return;const T=k();n.innerHTML=`
        <div style="text-align:center;">
          <div style="font-size:20px; font-weight:bold; text-decoration:underline;">${g.name}</div>
          <div style="margin-top:8px; font-size:16px;">${g.itemDescription||"No description yet."}</div>
          <div style="margin-top:8px; font-size:14px;">
            Cost: ${u(T)} korv<br>
            Duration: ${g.duration}s<br>
            Built: ${s.count}
          </div>
        </div>
      `}),h.addEventListener("mouseleave",()=>{n&&(n.innerHTML="")}),h.addEventListener("click",()=>{const T=k();o.korv>=T&&!s.constructing&&(o.korv-=T,Ge(a),H())});function ye(T,I){if(!i)return;let _=document.getElementById(`building-timer-${T}`);_||(_=document.createElement("div"),_.id=`building-timer-${T}`,_.style.fontSize="14px",_.style.marginTop="4px",i.appendChild(_)),_.textContent=`${g.name}: ${I}s`}function ve(T){const I=document.getElementById(`building-timer-${T}`);I&&I.remove()}return H(),h}for(const a in S){const s=f(a);s&&d.appendChild(s)}return t.appendChild(d),W=()=>{for(const a in S){const s=o.buildings[a];if(!s?.unlocked)continue;const g=t.querySelector(`button.kiosk-button:nth-child(${Object.keys(S).indexOf(a)+1})`);if(!g)continue;const h=g.querySelector("div");if(!h)continue;const y=S[a],v=Math.floor(y.baseCost*Math.pow(y.growthRate,s.count));if(s.constructing){const k=Math.ceil(s.remainingTime);g.disabled=!0,g.style.opacity="0.5",h.textContent=`${k}s`;const H=document.getElementById(`building-timer-${a}`);H&&(H.textContent=`${S[a].name}: ${k}s`)}else{g.disabled=!1,g.style.opacity="1",h.textContent=`${u(v)} korv`;const k=document.getElementById(`building-timer-${a}`);k&&k.remove()}}},q(W),function(){W&&(A(W),W=null)}}let V=null;function Xe({tabContent:t}){t.innerHTML="";const e=document.createElement("p");return e.textContent="Factory tab coming soon!",e.style.textAlign="center",e.style.marginTop="20px",t.appendChild(e),V=()=>{},q(V),function(){V&&(A(V),V=null)}}let G=null;function Qe({tabContent:t}){t.innerHTML="";const e=document.createElement("p");return e.textContent="Artifacts tab coming soon!",e.style.textAlign="center",e.style.marginTop="20px",t.appendChild(e),G=()=>{},q(G),function(){G&&(A(G),G=null)}}let Y=null;function Ze({tabContent:t}){t.innerHTML="";const e=document.createElement("p");return e.textContent="Spacecenter tab coming soon!",e.style.textAlign="center",e.style.marginTop="20px",t.appendChild(e),Y=()=>{},q(Y),function(){Y&&(A(Y),Y=null)}}function et(t,e){return e instanceof Set?{__type:"Set",values:Array.from(e)}:e}function tt(t,e){for(const n in t)delete t[n];for(const n in e)t[n]=e[n]}function nt(){try{const t=JSON.stringify(o,et,2),e="data:text/json;charset=utf-8,"+encodeURIComponent(t),n=document.createElement("a");n.setAttribute("href",e),n.setAttribute("download","korvkiosk_save.json"),n.click()}catch(t){console.error("Failed to export save:",t)}}function it(t){const e=new FileReader;e.onload=n=>{try{const i=JSON.parse(n.target.result);tt(o,i),o.boogie&&((typeof o.boogie.damageTypes!="object"||o.boogie.damageTypes===null)&&(o.boogie.damageTypes={}),Array.isArray(o.boogie.defeatedEnemies)?o.boogie.defeatedEnemies=new Set(o.boogie.defeatedEnemies):o.boogie.defeatedEnemies&&o.boogie.defeatedEnemies.__type==="Set"?o.boogie.defeatedEnemies=new Set(o.boogie.defeatedEnemies.values||[]):o.boogie.defeatedEnemies instanceof Set||(o.boogie.defeatedEnemies=new Set));for(const r in o.research){const c=o.research[r];c.researching&&!c.completed&&typeof c.lastUpdated!="number"&&(c.lastUpdated=Date.now())}o.korv!==void 0&&Q(o.korv),_e(),st(),console.log("✅ Save loaded, Sets restored, and timers resumed.")}catch(i){console.error("❌ Invalid save file:",i)}},e.readAsText(t)}let J=null;function ot({tabContent:t}){t.innerHTML="";const e=document.createElement("div");e.id="settings-container";const n=document.createElement("button");n.textContent="Export Save",n.onclick=nt;const i=document.createElement("label");i.textContent="Import Save: ",i.style.display="block",i.style.marginTop="10px";const r=document.createElement("input");return r.type="file",r.accept="application/json",r.onchange=c=>{const m=c.target.files[0];m&&it(m)},i.appendChild(r),e.appendChild(n),e.appendChild(i),t.appendChild(e),J=()=>{},q(J),function(){J&&(A(J),J=null),t.innerHTML=""}}const ce=new Set;function q(t){ce.add(t)}function A(t){ce.delete(t)}setInterval(()=>{ce.forEach(t=>{try{t()}catch(e){console.error("Error in update callback:",e)}})},1e3/30);const X=[{id:"kiosk",name:"Kiosk",render:De,unlocked:!0,icon:`${KorvkioskData.pluginUrl}src/game/Assets/img/kiosk/kiosk frame 0.png`},{id:"research",name:"Research",render:Be,unlocked:!0,icon:`${KorvkioskData.pluginUrl}src/game/Assets/img/research/beaker-frame-0.png`},{id:"equipment",name:"Equipment",render:je,unlocked:!0,icon:`${KorvkioskData.pluginUrl}src/game/Assets/img/equipment/equipment frame 0.png`},{id:"boogie",name:"Boogie",render:ge,unlocked:!0,icon:`${KorvkioskData.pluginUrl}src/game/Assets/img/boogie/duelframe0.png`},{id:"skills",name:"Skills",render:ze,unlocked:!0,icon:`${KorvkioskData.pluginUrl}src/game/Assets/img/Skills/Skill 1 - Throw.png`},{id:"recipes",name:"Recipes",render:Ve,unlocked:!0,icon:`${KorvkioskData.pluginUrl}src/game/Assets/img/recept/recipe-frame-0-.png`},{id:"buildings",name:"Buildings",render:Je,unlocked:!0,icon:`${KorvkioskData.pluginUrl}src/game/Assets/img/building/building upgrade frame 0.png`},{id:"factory",name:"Factory",render:Xe,unlocked:!0,icon:`${KorvkioskData.pluginUrl}src/game/Assets/img/fabrik/fabrik frame 0.png`},{id:"artifacts",name:"Artifacts",render:Qe,unlocked:!0,icon:`${KorvkioskData.pluginUrl}src/game/Assets/img/artifacts/artifacts frame 0.png`},{id:"spacecenter",name:"Spacecenter",render:Ze,unlocked:!0,icon:`${KorvkioskData.pluginUrl}src/game/Assets/img/spacecenter/spacecenter frame 0.png`},{id:"settings",name:"Settings",render:ot,unlocked:!0,icon:`${KorvkioskData.pluginUrl}src/game/Assets/img/inställningar/settings frame 0.png`}];let he=null,x,M,ne=null;function rt(){document.body.style.display="flex",document.body.style.justifyContent="center",document.body.style.alignItems="center",document.body.style.height="100vh",document.body.style.margin="0",document.body.style.background="#eee";const t=document.createElement("div");t.id="game-ui",t.style.width="1200px",t.style.height="600px",t.style.border="2px solid #444",t.style.display="flex",t.style.flexDirection="column",t.style.background="#f0f0f0",t.style.position="relative",x=document.createElement("div"),x.id="korv-counter",x.textContent="Korv: 0",x.style.position="absolute",x.style.top="10px",x.style.right="10px",x.style.color="#D2B04C",x.style.fontWeight="bold",x.style.fontSize="20px",x.style.fontFamily="monospace, sans-serif",x.style.userSelect="none",x.style.pointerEvents="none";const e=document.createElement("div");e.style.width="1200px",e.style.height="400px",e.style.display="flex",e.style.justifyContent="center",e.style.alignItems="center",e.style.background="#000",e.style.position="relative";const n=document.createElement("div");n.id="info-left",n.style.width="230px",n.style.height="100%",n.style.background="#e5e5e5",n.style.padding="10px",n.style.boxSizing="border-box",n.style.overflowY="auto",n.style.fontFamily="Arial, sans-serif",n.style.fontSize="20px",n.style.color="black",n.style.fontWeight="bold",n.style.display="flex",n.style.flexDirection="column",n.style.justifyContent="center",n.style.alignItems="center";const i=document.createElement("div");i.className="main-screen",i.style.width="740px",i.style.height="100%",i.style.background="#e5e5e5",i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i.style.overflow="hidden";const r=document.createElement("div");r.id="info-right",r.style.width="230px",r.style.height="100%",r.style.background="#e5e5e5",r.style.color="#c41313ff",r.style.padding="10px",r.style.boxSizing="border-box",r.style.overflowY="auto",r.style.fontFamily="Arial, sans-serif",r.style.fontSize="20px",r.style.color="black",r.style.fontWeight="bold",r.style.display="flex",r.style.flexDirection="column",r.style.justifyContent="center",r.style.alignItems="center",e.appendChild(n),e.appendChild(i),e.appendChild(r),M=document.createElement("div"),M.className="tab-buttons",M.style.height="50px",M.style.flexShrink="0",M.style.display="flex",M.style.justifyContent="flex-start",M.style.alignItems="center",M.style.background="#ddd",M.style.borderBottom="2px solid #999";const c=document.createElement("div");c.className="tab-content",c.style.flexGrow="1",c.style.padding="10px",c.style.overflow="auto",c.style.background="#fafafa",t.appendChild(e),t.appendChild(M),t.appendChild(c),t.appendChild(x),document.body.appendChild(t),X.filter(d=>d.unlocked).forEach(d=>{const u=document.createElement("button");u.id=`btn-${d.id}`,u.style.padding="0px 10px",u.style.fontSize="16px",u.style.cursor="pointer",u.innerHTML=`
      <img src="${d.icon}" alt="${d.name}" style="width:32px; height:32px; vertical-align:middle; margin-right:5px;">
      ${d.name}
    `,u.onclick=()=>m(d.id),M.appendChild(u)});function m(d){ne&&(ne(),ne=null),he=d;const u=X.find(f=>f.id===d);if(u){c.innerHTML="",i.innerHTML="",n.innerHTML="",r.innerHTML="";const f=u.render({tabContent:c,mainScreen:i,infoLeft:n,infoRight:r});typeof f=="function"&&(ne=f)}p(d)}function p(d){X.forEach(u=>{const f=document.getElementById(`btn-${u.id}`);f&&f.classList.toggle("active",u.id===d)})}m(X[0].id)}q(Q);function Q(){x&&(x.textContent=`Korv: ${o.korv} / ${o.korvtak}`)}function st(){const t=X.find(e=>e.id===he);t&&t.render({tabContent:document.querySelector(".tab-content"),mainScreen:document.querySelector(".main-screen"),infoLeft:document.getElementById("info-left"),infoRight:document.getElementById("info-right")})}function at(t){const e=t/1e3,n=o.boogie;if(!n)return;const i=n.regeneration||0,r=Object.values(n.regenBonuses||{}).reduce((m,p)=>m+p,0),c=i+r;c<=0||n.currentHP<n.maxHP&&(n.currentHP=Math.min(n.currentHP+c*e,n.maxHP))}function lt(t){}function ct(){rt(),D(Le),D(at),D(lt),D(Re),D(Ye)}document.addEventListener("DOMContentLoaded",()=>{ct()});
